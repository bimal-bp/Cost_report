<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGX MINERALS - Excel-style Production Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .excel-container {
            background-color: white;
            border: 1px solid #ddd;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .company-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .report-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .report-date {
            text-align: right;
            margin-bottom: 20px;
        }
        
        .excel-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .excel-table th, .excel-table td {
            border: 1px solid #ddd;
            padding: 6px 8px;
            text-align: left;
        }
        
        .excel-table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        
        .input-cell {
            padding: 0;
            height: 28px;
        }
        
        .input-cell input {
            width: 100%;
            height: 100%;
            border: none;
            padding: 5px;
            box-sizing: border-box;
        }
        
        .input-cell input:focus {
            outline: 2px solid #4CAF50;
            background-color: #f8fff8;
        }
        
        .calculated-cell {
            background-color: #f9f9f9;
            font-weight: bold;
        }
        
        .section-divider {
            border-top: 2px solid #333;
            margin: 15px 0;
        }
        
        .form-actions {
            text-align: center;
            margin-top: 20px;
        }
        
        .btn {
            padding: 8px 15px;
            margin: 0 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .btn-save {
            background-color: #4CAF50;
            color: white;
        }
        
        .btn-reset {
            background-color: #f44336;
            color: white;
        }
        
        .btn-print {
            background-color: #2196F3;
            color: white;
        }
        
        .status-bar {
            background-color: #333;
            color: white;
            padding: 8px 15px;
            margin-bottom: 15px;
            border-radius: 4px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="excel-container">
        <div class="status-bar">
            <span id="current-date-time">Loading date and time...</span> | 
            <span class="unsaved-changes">UNSAVED CHANGES</span>
        </div>
        
        <div class="company-header">
            <h2>SGX MINERALS PVT LTD - MICRO DIVISION</h2>
        </div>
        
        <div class="report-title">DAY Shift Production Report</div>
        
        <div class="report-date">
            <label for="report-date">Date: </label>
            <input type="date" id="report-date" style="border: 1px solid #ddd; padding: 3px;">
            <label for="shift-name" style="margin-left: 15px;">Shift Name: </label>
            <select id="shift-name" style="border: 1px solid #ddd; padding: 3px;">
                <option>Day Shift</option>
                <option>Night Shift</option>
            </select>
        </div>
        
        <table class="excel-table">
            <tr>
                <th colspan="2">QC / Chemist Responsibility :</th>
                <th>SGX Raw : (PSD / SIO2)</th>
                <th>RH- (PSD / SIO2)</th>
                <th>Day Shift</th>
                <th>Accelerator- (PSD / SIO2)</th>
            </tr>
            <tr>
                <td colspan="2"><input type="text" id="qc-chemist" value="Rabindra" style="width: 100%; border: none;"></td>
                <td class="input-cell"><input type="number" step="0.01" value="144.3"></td>
                <td class="input-cell"><input type="number" step="0.01" value="50.16"></td>
                <td class="input-cell"><input type="number" step="0.01" value="52.16"></td>
                <td class="input-cell"><input type="number" step="0.01"></td>
            </tr>
            <tr>
                <td colspan="2"></td>
                <td>D-80</td>
                <td>D-80</td>
                <td>D-80</td>
                <td>D-80</td>
            </tr>
            <tr>
                <td colspan="2"></td>
                <td class="input-cell"><input type="number" step="0.01" value="205.7"></td>
                <td class="input-cell"><input type="number" step="0.01" value="62.96"></td>
                <td class="input-cell"><input type="number" step="0.01" value="67.74"></td>
                <td class="input-cell"><input type="number" step="0.01"></td>
            </tr>
            <tr>
                <td colspan="2"></td>
                <td>D-90</td>
                <td>D-90</td>
                <td>D-90</td>
                <td>D-90</td>
            </tr>
            <tr>
                <td colspan="2">Raw Material Opening Stock</td>
                <td class="input-cell"><input type="number" step="0.1" value="0"></td>
                <td class="input-cell"><input type="number" step="0.1" value="0"></td>
                <td class="input-cell"><input type="number" step="0.1" value="4.6"></td>
                <td class="input-cell"><input type="number" step="0.1"></td>
            </tr>
            <tr>
                <td colspan="2">Mixing Material Opening Stock</td>
                <td class="input-cell"><input type="number" step="0.1" value="0"></td>
                <td class="input-cell"><input type="number" step="0.1" value="0"></td>
                <td class="input-cell"><input type="number" step="0.1" value="0"></td>
                <td class="input-cell"><input type="number" step="0.1" value="0"></td>
            </tr>
            <tr>
                <td colspan="2">Mixing Responsibility :</td>
                <td colspan="4" class="input-cell"><input type="text" value="Chitaranjan Bag"></td>
            </tr>
            <tr>
                <td colspan="2">Mixing & Feeding in MT:-</td>
                <td class="input-cell"><input type="number" step="0.1" value="0"></td>
                <td>Mixing Ratio:-</td>
                <td class="input-cell"><input type="text" value="0.00.00"></td>
                <td>JCB running hrs:-</td>
                <td class="input-cell"><input type="number" step="0.1" value="4"></td>
            </tr>
            <tr>
                <td colspan="2">Mixing Cost Per Mt :</td>
                <td class="input-cell"><input type="number" step="0.01" value="0.00"></td>
                <td>JCB Cost:-</td>
                <td class="input-cell"><input type="number" step="0.01" value="3256.64"></td>
                <td>NMR Cost :-</td>
                <td class="input-cell"><input type="number" step="0.01" value="7700.00"></td>
                <td>LDO Cost</td>
                <td class="input-cell"><input type="number" step="0.01" value="0.00"></td>
            </tr>
        </table>
        
        <table class="excel-table">
            <tr>
                <th colspan="2">QC / Chemist Responsibility :</th>
                <th>Ground Mixing:- (PSD / SIO2)</th>
                <th>Dryer Output:- (PSD)</th>
                <th>Silo Output :- (PSD)</th>
                <th>VRM output:- (PSD / SIO2)</th>
            </tr>
            <tr>
                <td colspan="2" class="input-cell"><input type="text" value="Soumya Ranjan , Suraj Pal"></td>
                <td class="input-cell"><input type="number" step="0.01"></td>
                <td class="input-cell"><input type="number" step="0.01"></td>
                <td class="input-cell"><input type="number" step="0.01"></td>
                <td class="input-cell"><input type="number" step="0.01"></td>
            </tr>
            <tr>
                <td colspan="2"></td>
                <td>D-80</td>
                <td>D-80</td>
                <td>D-80</td>
                <td>D-80</td>
            </tr>
            <tr>
                <td colspan="2"></td>
                <td class="input-cell"><input type="number" step="0.01"></td>
                <td class="input-cell"><input type="number" step="0.01"></td>
                <td class="input-cell"><input type="number" step="0.01"></td>
                <td class="input-cell"><input type="number" step="0.01"></td>
            </tr>
            <tr>
                <td colspan="2"></td>
                <td>D-90</td>
                <td>D-90</td>
                <td>D-90</td>
                <td>D-90</td>
            </tr>
        </table>
        
        <div class="section-divider"></div>
        
        <table class="excel-table">
            <tr>
                <th colspan="4">Operation Responsibility</th>
            </tr>
            <tr>
                <td colspan="4" class="input-cell"><input type="text" value="Names: Mr. Sourabh Lad"></td>
            </tr>
            <tr>
                <th colspan="2">DRYER OPERATIONS</th>
                <th>Dryer Start Time:-</th>
                <th class="input-cell"><input type="time"></th>
                <th>Dryer End Time:-</th>
                <th class="input-cell"><input type="time"></th>
            </tr>
            <tr>
                <td>Dryer Output In Mt:-</td>
                <td class="input-cell"><input type="number" step="0.1" value="0"></td>
                <td>Dryer Running Time:-</td>
                <td class="input-cell calculated-cell"></td>
                <td>Dryer TPH:-</td>
                <td class="input-cell calculated-cell"></td>
            </tr>
            <tr>
                <td>LDO Opening Stock :-</td>
                <td class="input-cell"><input type="number" step="0.1"></td>
                <td>LDO Closing Stock :-</td>
                <td class="input-cell"><input type="number" step="0.1"></td>
                <td>LDO Consume :-</td>
                <td class="input-cell calculated-cell"></td>
            </tr>
            <tr>
                <td>Silo Stock:-</td>
                <td class="input-cell"><input type="number" step="0.1"></td>
                <td>NMR :-</td>
                <td class="input-cell"><input type="number" value="11"></td>
                <td>JCB Running Hrs :-</td>
                <td class="input-cell"><input type="number" step="0.1" value="4"></td>
            </tr>
            <tr>
                <td>Dryer Cost</td>
                <td class="input-cell calculated-cell">#DIV/01</td>
            </tr>
        </table>
        
        <div class="section-divider"></div>
        
        <table class="excel-table">
            <tr>
                <th colspan="6">VRM OPERATIONS</th>
            </tr>
            <tr>
                <td>Product Name:-</td>
                <td colspan="5" class="input-cell"><input type="text" value="MicroSilica AMS"></td>
            </tr>
            <tr>
                <td>VRM Start Time</td>
                <td class="input-cell"><input type="time"></td>
                <td>VRM End Time :-</td>
                <td class="input-cell"><input type="time"></td>
            </tr>
            <tr>
                <td>VRM Production :-</td>
                <td class="input-cell"><input type="number" step="0.1" value="0"></td>
                <td>VRM running Hrs:-</td>
                <td class="input-cell calculated-cell"></td>
                <td>VRM TPH</td>
                <td class="input-cell calculated-cell"></td>
            </tr>
            <tr>
                <td>EB start :</td>
                <td class="input-cell"><input type="number" value="8124"></td>
                <td>EB closing :-</td>
                <td class="input-cell"><input type="number" value="8142"></td>
                <td>Units consums :-</td>
                <td class="input-cell"><input type="number" value="72"></td>
            </tr>
            <tr>
                <td>NMR</td>
                <td class="input-cell"><input type="number" value="11"></td>
                <td>NMR Cost</td>
                <td class="input-cell"><input type="number" step="0.01" value="7700.00"></td>
            </tr>
            <tr>
                <td>EB Cost /MT:-</td>
                <td class="input-cell"><input type="number" step="0.01" value="884.16"></td>
                <td>Beg Cost</td>
                <td class="input-cell"><input type="number" step="0.01" value="0.00"></td>
            </tr>
            <tr>
                <td>Forklift Cost /MT</td>
                <td class="input-cell"><input type="number" step="0.01" value="2115.40"></td>
                <td>Spare Cost</td>
                <td class="input-cell"><input type="number" step="0.01" value="0.00"></td>
            </tr>
            <tr>
                <td>Bags Unloading Cost</td>
                <td class="input-cell"><input type="number" step="0.01" value="0"></td>
                <td>Bags Loading Cost</td>
                <td class="input-cell"><input type="number" step="0.01" value="8800.00"></td>
            </tr>
            <tr>
                <td>VRM Cost / Mt</td>
                <td colspan="5" class="calculated-cell">#DIV/01</td>
            </tr>
            <tr>
                <td>Total Production Cost /MT</td>
                <td class="calculated-cell">#DIV/01</td>
                <td>Total Production Cost /KG:-</td>
                <td class="calculated-cell">#DIV/01</td>
            </tr>
        </table>
        
        <div class="form-actions">
            <button class="btn btn-save">Save Report</button>
            <button class="btn btn-reset">Reset Form</button>
            <button class="btn btn-print">Print Report</button>
        </div>
    </div>

    <script>
        // Update current date and time
        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            };
            document.getElementById('current-date-time').textContent = now.toLocaleDateString('en-US', options);
        }
        
        // Set initial date and update every second
        updateDateTime();
        setInterval(updateDateTime, 1000);
        
        // Set default date to today
        document.getElementById('report-date').valueAsDate = new Date();
        
        // Calculate time difference between start and end
        function calculateTimeDifference(startInput, endInput, resultCell) {
            const startTime = startInput.value;
            const endTime = endInput.value;
            
            if (startTime && endTime) {
                const start = new Date(`2000-01-01T${startTime}`);
                const end = new Date(`2000-01-01T${endTime}`);
                
                if (end >= start) {
                    const diffMs = end - start;
                    const diffHrs = Math.floor(diffMs / 3600000);
                    const diffMins = Math.floor((diffMs % 3600000) / 60000);
                    
                    resultCell.textContent = `${diffHrs} hrs ${diffMins} mins`;
                    return diffHrs + (diffMins / 60);
                }
            }
            return 0;
        }
        
        // Calculate TPH (Tons Per Hour)
        function calculateTPH(productionInput, hours, resultCell) {
            const production = parseFloat(productionInput.value) || 0;
            const tph = hours > 0 ? (production / hours).toFixed(2) : 0;
            resultCell.textContent = tph;
            return parseFloat(tph);
        }
        
        // Calculate consumption
        function calculateConsumption(openingInput, closingInput, resultCell) {
            const opening = parseFloat(openingInput.value) || 0;
            const closing = parseFloat(closingInput.value) || 0;
            const consumed = opening - closing;
            resultCell.textContent = consumed > 0 ? consumed.toFixed(2) : '0.00';
            return consumed > 0 ? consumed : 0;
        }
        
        // Initialize event listeners for calculations
        document.addEventListener('DOMContentLoaded', function() {
            // Get all input elements that need calculations
            const dryerStart = document.querySelector('input[type="time"]:nth-of-type(1)');
            const dryerEnd = document.querySelector('input[type="time"]:nth-of-type(2)');
            const dryerRunningTime = document.querySelectorAll('.calculated-cell')[0];
            const dryerOutput = document.querySelector('input[type="number"][value="0"]');
            const dryerTph = document.querySelectorAll('.calculated-cell')[1];
            
            const vrmStart = document.querySelector('input[type="time"]:nth-of-type(3)');
            const vrmEnd = document.querySelector('input[type="time"]:nth-of-type(4)');
            const vrmRunningHrs = document.querySelectorAll('.calculated-cell')[2];
            const vrmProduction = document.querySelector('input[type="number"][value="0"]:nth-of-type(12)');
            const vrmTph = document.querySelectorAll('.calculated-cell')[3];
            
            const ldoOpening = document.querySelector('input[type="number"]:nth-of-type(14)');
            const ldoClosing = document.querySelector('input[type="number"]:nth-of-type(15)');
            const ldoConsume = document.querySelectorAll('.calculated-cell')[4];
            
            // Add event listeners
            if (dryerStart && dryerEnd) {
                dryerStart.addEventListener('change', function() {
                    const hours = calculateTimeDifference(dryerStart, dryerEnd, dryerRunningTime);
                    calculateTPH(dryerOutput, hours, dryerTph);
                });
                
                dryerEnd.addEventListener('change', function() {
                    const hours = calculateTimeDifference(dryerStart, dryerEnd, dryerRunningTime);
                    calculateTPH(dryerOutput, hours, dryerTph);
                });
            }
            
            if (vrmStart && vrmEnd) {
                vrmStart.addEventListener('change', function() {
                    const hours = calculateTimeDifference(vrmStart, vrmEnd, vrmRunningHrs);
                    calculateTPH(vrmProduction, hours, vrmTph);
                });
                
                vrmEnd.addEventListener('change', function() {
                    const hours = calculateTimeDifference(vrmStart, vrmEnd, vrmRunningHrs);
                    calculateTPH(vrmProduction, hours, vrmTph);
                });
            }
            
            if (ldoOpening && ldoClosing) {
                ldoOpening.addEventListener('change', function() {
                    calculateConsumption(ldoOpening, ldoClosing, ldoConsume);
                });
                
                ldoClosing.addEventListener('change', function() {
                    calculateConsumption(ldoOpening, ldoClosing, ldoConsume);
                });
            }
            
            // Print button functionality
            document.querySelector('.btn-print').addEventListener('click', function() {
                window.print();
            });
        });
    </script>
</body>
</html>
